"use strict";
var chai = require("chai");
var index_1 = require("../index");
var Player = new index_1.vlcdaemon({ verbose: true, fullscreen: true });
var testsources = [
    { uri: "v4l2:///dev/video0" },
    { title: "test2", uri: '/home/dario/Video/streamcc-1505976677.flv.ok.flv' }
];
var expect = chai.expect;
describe("mpv class", function () {
    describe("configuration", function () {
        it("expect return an object", function () {
            expect(Player).to.be.ok;
        });
        it("expect to have property playlist", function () {
            expect(Player).to.have.property('playlist').that.is.an('array');
        });
        it("expect to have property daemonized", function () {
            expect(Player).to.have.property('daemonized').that.is.not.ok;
        });
        it("start", function (done) {
            this.timeout(50000);
            Player.start().then(function (a) {
                expect(Player).to.have.property('daemonized').that.is.ok;
                done();
            }).catch(function (err) {
                expect(err).to.not.exist;
                done();
            });
        });
        it("player is now daemonized", function () {
            expect(Player).to.have.property('daemonized').that.is.ok;
        });
        it("player is not playing now", function () {
            expect(Player).to.have.property('playing').that.is.not.ok;
        });
    });
    describe("playlist", function () {
        it("load a playlist from object", function (done) {
            this.timeout(50000);
            Player.loadList(testsources).then(function (a) {
                expect(Player.playlist.length).to.be.eq(2);
                expect(Player.playlist[0]).to.have.property('uri').that.eq(testsources[0].uri);
                expect(Player.playlist[0]).to.have.property('label').that.is.a("string");
                expect(Player.playlist[1]).to.have.property('title').that.eq("test2");
                expect(Player.playlist[1]).to.have.property('uri').that.eq(testsources[1].uri);
                expect(Player.playlist[1]).to.have.property('label').that.is.a("string");
                setTimeout(function () {
                    done();
                }, 23000);
            }).catch(function (err) {
                console.log(err);
                expect(err).to.not.exist;
                done();
            });
        });
        it("player is still running", function () {
            expect(Player).to.have.property('playing').that.is.ok;
        });
        it("switch to next track what", function (done) {
            this.timeout(50000);
            Player.to(1).then(function (a) {
                expect(Player.playlist.length).to.be.eq(2);
                expect(Player).to.have.property('track').that.eq(2);
                setTimeout(function () {
                    done();
                }, 23000);
            }).catch(function (err) {
                done(Error(err));
            });
        });
        it("switch to prev track best", function (done) {
            this.timeout(50000);
            Player.prev().then(function (a) {
                expect(Player.playlist.length).to.be.eq(2);
                expect(Player).to.have.property('track').that.eq(1);
                setTimeout(function () {
                    done();
                }, 3000);
            }).catch(function (err) {
                done(Error(err));
            });
        });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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MkJBQTJCLEVBQUUsVUFBVSxJQUFJO1lBQzFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFcEIsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFDLENBQUM7Z0JBQ2pCLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUMzQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtnQkFHbkQsVUFBVSxDQUFDO29CQUNQLElBQUksRUFBRSxDQUFBO2dCQUNWLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQTtZQUVaLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFDLEdBQUc7Z0JBRVQsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO1lBQ3BCLENBQUMsQ0FBQyxDQUFBO1FBQ04sQ0FBQyxDQUFDLENBQUM7SUFNUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvY2hlY2tsb2FkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgbW9jaGEgZnJvbSBcIm1vY2hhXCI7XG5pbXBvcnQgKiBhcyBjaGFpIGZyb20gXCJjaGFpXCI7XG5cbi8vIGltcG9ydCBjb3VjaGF1dGg9IHJlcXVpcmUoXCIuLi9pbmRleFwiKTtcblxuaW1wb3J0IHsgdmxjZGFlbW9uIH0gZnJvbSBcIi4uL2luZGV4XCI7XG5cblxuY29uc3QgUGxheWVyID0gbmV3IHZsY2RhZW1vbih7dmVyYm9zZTp0cnVlLCBmdWxsc2NyZWVuOiB0cnVlfSlcblxuXG5jb25zdCB0ZXN0c291cmNlcz1bXG4gICAgeyB1cmk6IFwidjRsMjovLy9kZXYvdmlkZW8wXCIgfSxcbiAgICB7IHRpdGxlOiBcInRlc3QyXCIsIHVyaTogJy9ob21lL2RhcmlvL1ZpZGVvL3N0cmVhbWNjLTE1MDU5NzY2NzcuZmx2Lm9rLmZsdicgfVxuXVxuXG5cbmNvbnN0IGV4cGVjdCA9IGNoYWkuZXhwZWN0O1xuXG5kZXNjcmliZShcIm1wdiBjbGFzc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgZGVzY3JpYmUoXCJjb25maWd1cmF0aW9uXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBpdChcImV4cGVjdCByZXR1cm4gYW4gb2JqZWN0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIpLnRvLmJlLm9rO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdG8gaGF2ZSBwcm9wZXJ0eSBwbGF5bGlzdFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBlY3QoUGxheWVyKS50by5oYXZlLnByb3BlcnR5KCdwbGF5bGlzdCcpLnRoYXQuaXMuYW4oJ2FycmF5Jyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCB0byBoYXZlIHByb3BlcnR5IGRhZW1vbml6ZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KFBsYXllcikudG8uaGF2ZS5wcm9wZXJ0eSgnZGFlbW9uaXplZCcpLnRoYXQuaXMubm90Lm9rXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic3RhcnRcIiwgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgICAgIHRoaXMudGltZW91dCg1MDAwMCk7XG5cbiAgICAgICAgICAgIFBsYXllci5zdGFydCgpLnRoZW4oZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBleHBlY3QoUGxheWVyKS50by5oYXZlLnByb3BlcnR5KCdkYWVtb25pemVkJykudGhhdC5pcy5va1xuICAgICAgICAgICAgICAgIGRvbmUoKVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIGV4cGVjdChlcnIpLnRvLm5vdC5leGlzdFxuICAgICAgICAgICAgICAgIGRvbmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwicGxheWVyIGlzIG5vdyBkYWVtb25pemVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIpLnRvLmhhdmUucHJvcGVydHkoJ2RhZW1vbml6ZWQnKS50aGF0LmlzLm9rXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcInBsYXllciBpcyBub3QgcGxheWluZyBub3dcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwZWN0KFBsYXllcikudG8uaGF2ZS5wcm9wZXJ0eSgncGxheWluZycpLnRoYXQuaXMubm90Lm9rXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG5cbiAgICBkZXNjcmliZShcInBsYXlsaXN0XCIsIGZ1bmN0aW9uICgpIHtcblxuXG4gICAgICAgIGl0KFwibG9hZCBhIHBsYXlsaXN0IGZyb20gb2JqZWN0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQoNTAwMDApO1xuXG4gICAgICAgICAgICBQbGF5ZXIubG9hZExpc3QodGVzdHNvdXJjZXMpLnRoZW4oKGEpID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoUGxheWVyLnBsYXlsaXN0Lmxlbmd0aCkudG8uYmUuZXEoMik7XG4gICAgICAgICAgICAgICAgZXhwZWN0KFBsYXllci5wbGF5bGlzdFswXSkudG8uaGF2ZS5wcm9wZXJ0eSgndXJpJykudGhhdC5lcSh0ZXN0c291cmNlc1swXS51cmkpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIucGxheWxpc3RbMF0pLnRvLmhhdmUucHJvcGVydHkoJ2xhYmVsJykudGhhdC5pcy5hKFwic3RyaW5nXCIpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIucGxheWxpc3RbMV0pLnRvLmhhdmUucHJvcGVydHkoJ3RpdGxlJykudGhhdC5lcShcInRlc3QyXCIpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIucGxheWxpc3RbMV0pLnRvLmhhdmUucHJvcGVydHkoJ3VyaScpLnRoYXQuZXEodGVzdHNvdXJjZXNbMV0udXJpKTtcbiAgICAgICAgICAgICAgICBleHBlY3QoUGxheWVyLnBsYXlsaXN0WzFdKS50by5oYXZlLnByb3BlcnR5KCdsYWJlbCcpLnRoYXQuaXMuYShcInN0cmluZ1wiKTtcblxuXG4gICAgICAgICAgICAvLyAgICBleHBlY3QoUGxheWVyLnBsYXlpbmcpLnRvLmJlLm9rO1xuXG5cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpXG4gICAgICAgICAgICAgICAgfSwgMjMwMDApXG5cbiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycikudG8ubm90LmV4aXN0XG4gICAgICAgICAgICAgICAgZG9uZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInBsYXllciBpcyBzdGlsbCBydW5uaW5nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cGVjdChQbGF5ZXIpLnRvLmhhdmUucHJvcGVydHkoJ3BsYXlpbmcnKS50aGF0LmlzLm9rXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic3dpdGNoIHRvIG5leHQgdHJhY2sgd2hhdFwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgdGhpcy50aW1lb3V0KDUwMDAwKTtcblxuICAgICAgICAgICAgUGxheWVyLnRvKDEpLnRoZW4oKGEpID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoUGxheWVyLnBsYXlsaXN0Lmxlbmd0aCkudG8uYmUuZXEoMik7XG4gICAgICAgICAgICAgICAgZXhwZWN0KFBsYXllcikudG8uaGF2ZS5wcm9wZXJ0eSgndHJhY2snKS50aGF0LmVxKDIpXG5cblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkb25lKClcbiAgICAgICAgICAgICAgICB9LCAyMzAwMClcblxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGRvbmUoRXJyb3IoZXJyKSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgaXQoXCJzd2l0Y2ggdG8gcHJldiB0cmFjayBiZXN0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQoNTAwMDApO1xuXG4gICAgICAgICAgICBQbGF5ZXIucHJldigpLnRoZW4oKGEpID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoUGxheWVyLnBsYXlsaXN0Lmxlbmd0aCkudG8uYmUuZXEoMik7XG4gICAgICAgICAgICAgICAgZXhwZWN0KFBsYXllcikudG8uaGF2ZS5wcm9wZXJ0eSgndHJhY2snKS50aGF0LmVxKDEpXG5cblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkb25lKClcbiAgICAgICAgICAgICAgICB9LCAzMDAwKVxuXG4gICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBkb25lKEVycm9yKGVycikpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcblxuXG5cbiAgICBcblxuICAgIH0pO1xufSk7Il19
